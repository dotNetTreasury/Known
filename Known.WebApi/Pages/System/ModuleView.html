<div class="mini-splitter" style="width:100%;height:100%;">
    <div id="splitLeft" tooltip="关闭/显示菜单" size="180px" showCollapseButton="true">
        <ul id="leftTree" class="mini-tree" style="width:178px;"></ul>
    </div>
    <div id="splitRight"></div>
</div>

<script>
    var ModuleView = {

        leftTree: null,

        show: function () {
            var _this = this;
            this.leftTree = mini.get('leftTree');
            this.leftTree.set({
                url: '/api/Module/GetTreeDatas', resultAsTree: false,
                allowDrag: true, allowDrop: true, allowLeafDropIn: true
            });
            this.leftTree.on('nodeclick', function (e) { _this.treeNodeClick(e); });
            this.leftTree.on('drop', function (e) { _this.treeNodeDrop(e); });

            this.showGrid({ id: '0' });
        },

        //tree
        treeNodeClick: function (e) {
            this.showGrid(e.node);
        },

        treeNodeDrop: function (e) {
            console.log(e);
        },

        //private
        showGrid: function (node) {
            var _this = this;
            var option = {
                node: node,
                callback: function () {
                    _this.leftTree.reload();
                }
            };
            var splitRight = $('#splitRight');
            if (splitRight.html().length) {
                ModuleGrid.show(option);
            } else {
                splitRight.loadView('/System/Partials/ModuleGrid', option);
            }
        }

    };
</script>